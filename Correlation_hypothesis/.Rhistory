dengue_longformat$Province <- province_names
#let's just order the columns
monsoon_longformat <- data.frame(Province = province_names, Year = years, Month = months, Dengue = stacked_years)
#let's just order the columns
dengue_longformat <- data.frame(Province = province_names, Year = years, Month = months, Dengue = stacked_years)
#we need to stack the humidity data in the same year
stackedH_01 <- c(T.huss.mon1$"2006.01.", T.huss.mon1$"2006.02.")
#we need to stack the humidity data in the same year
stackedH_06 <- c(T.huss.mon1$"2006.01.", T.huss.mon1$"2006.02.", T.huss.mon1$"2006.03.", T.huss.mon1$"2006.04.", T.huss.mon1$"2006.05.", T.huss.mon1$"2006.06.", T.huss.mon1$"2006.07.", T.huss.mon1$"2006.08.", T.huss.mon1$"2006.09.", T.huss.mon1$"2006.10.", T.huss.mon1$"2006.11.", T.huss.mon1$"2006.12.")
stackedH_07 <- c(T.huss.mon1$"2007.01.", T.huss.mon1$"2007.02.", T.huss.mon1$"2007.03.", T.huss.mon1$"2007.04.", T.huss.mon1$"2007.05.", T.huss.mon1$"2007.06.", T.huss.mon1$"2007.07.", T.huss.mon1$"2007.08.", T.huss.mon1$"2007.09.", T.huss.mon1$"2007.10.", T.huss.mon1$"2007.11.", T.huss.mon1$"2007.12.")
stackedH_08 <- c(T.huss.mon1$"2008.01.", T.huss.mon1$"2008.02.", T.huss.mon1$"2008.03.", T.huss.mon1$"2008.04.", T.huss.mon1$"2008.05.", T.huss.mon1$"2008.06.", T.huss.mon1$"2008.07.", T.huss.mon1$"2008.08.", T.huss.mon1$"2008.09.", T.huss.mon1$"2008.10.", T.huss.mon1$"2008.11.", T.huss.mon1$"2008.12.")
stackedH_09 <- c(T.huss.mon1$"2009.01.", T.huss.mon1$"2009.02.", T.huss.mon1$"2009.03.", T.huss.mon1$"2009.04.", T.huss.mon1$"2009.05.", T.huss.mon1$"2009.06.", T.huss.mon1$"2009.07.", T.huss.mon1$"2009.08.", T.huss.mon1$"2009.09.", T.huss.mon1$"2009.10.", T.huss.mon1$"2009.11.", T.huss.mon1$"2009.12.")
stackedH_10 <- c(T.huss.mon1$"2010.01.", T.huss.mon1$"2010.02.", T.huss.mon1$"2010.03.", T.huss.mon1$"2010.04.", T.huss.mon1$"2010.05.", T.huss.mon1$"2010.06.", T.huss.mon1$"2010.07.", T.huss.mon1$"2010.08.", T.huss.mon1$"2010.09.", T.huss.mon1$"2010.10.", T.huss.mon1$"2010.11.", T.huss.mon1$"2010.12.")
stackedH_11 <- c(T.huss.mon1$"2011.01.", T.huss.mon1$"2011.02.", T.huss.mon1$"2011.03.", T.huss.mon1$"2011.04.", T.huss.mon1$"2011.05.", T.huss.mon1$"2011.06.", T.huss.mon1$"2011.07.", T.huss.mon1$"2011.08.", T.huss.mon1$"2011.09.", T.huss.mon1$"2011.10.", T.huss.mon1$"2011.11.", T.huss.mon1$"2011.12.")
stackedH_12 <- c(T.huss.mon1$"2012.01.", T.huss.mon1$"2012.02.", T.huss.mon1$"2012.03.", T.huss.mon1$"2012.04.", T.huss.mon1$"2012.05.", T.huss.mon1$"2012.06.", T.huss.mon1$"2012.07.", T.huss.mon1$"2012.08.", T.huss.mon1$"2012.09.", T.huss.mon1$"2012.10.", T.huss.mon1$"2012.11.", T.huss.mon1$"2012.12.")
stackedH_13 <- c(T.huss.mon1$"2013.01.", T.huss.mon1$"2013.02.", T.huss.mon1$"2013.03.", T.huss.mon1$"2013.04.", T.huss.mon1$"2013.05.", T.huss.mon1$"2013.06.", T.huss.mon1$"2013.07.", T.huss.mon1$"2013.08.", T.huss.mon1$"2013.09.", T.huss.mon1$"2013.10.", T.huss.mon1$"2013.11.", T.huss.mon1$"2013.12.")
stackedH_14 <- c(T.huss.mon1$"2014.01.", T.huss.mon1$"2014.02.", T.huss.mon1$"2014.03.", T.huss.mon1$"2014.04.", T.huss.mon1$"2014.05.", T.huss.mon1$"2014.06.", T.huss.mon1$"2014.07.", T.huss.mon1$"2014.08.", T.huss.mon1$"2014.09.", T.huss.mon1$"2014.10.", T.huss.mon1$"2014.11.", T.huss.mon1$"2014.12.")
stackedH_15 <- c(T.huss.mon1$"2015.01.", T.huss.mon1$"2015.02.", T.huss.mon1$"2015.03.", T.huss.mon1$"2015.04.", T.huss.mon1$"2015.05.", T.huss.mon1$"2015.06.", T.huss.mon1$"2015.07.", T.huss.mon1$"2015.08.", T.huss.mon1$"2015.09.", T.huss.mon1$"2015.10.", T.huss.mon1$"2015.11.", T.huss.mon1$"2015.12.")
stackedH16 <- c(T.huss.mon1$"2016.01.", T.huss.mon1$"2016.02.", T.huss.mon1$"2016.03.", T.huss.mon1$"2016.04.", T.huss.mon1$"2016.05.", T.huss.mon1$"2016.06.", T.huss.mon1$"2016.07.", T.huss.mon1$"2016.08.", T.huss.mon1$"2016.09.", T.huss.mon1$"2016.10.", T.huss.mon1$"2016.11.", T.huss.mon1$"2016.12.")
stackedH_17 <- c(T.huss.mon1$"2017.01.", T.huss.mon1$"2017.02.", T.huss.mon1$"2017.03.", T.huss.mon1$"2017.04.", T.huss.mon1$"2017.05.", T.huss.mon1$"2017.06.", T.huss.mon1$"2017.07.", T.huss.mon1$"2017.08.", T.huss.mon1$"2017.09.", T.huss.mon1$"2017.10.", T.huss.mon1$"2017.11.", T.huss.mon1$"2017.12.")
stackedH_18 <- c(T.huss.mon1$"2018.01.", T.huss.mon1$"2018.02.", T.huss.mon1$"2018.03.", T.huss.mon1$"2018.04.", T.huss.mon1$"2018.05.", T.huss.mon1$"2018.06.", T.huss.mon1$"2018.07.", T.huss.mon1$"2018.08.", T.huss.mon1$"2018.09.", T.huss.mon1$"2018.10.", T.huss.mon1$"2018.11.", T.huss.mon1$"2018.12.")
stackedH_19 <- c(T.huss.mon1$"2019.01.", T.huss.mon1$"2019.02.", T.huss.mon1$"2019.03.", T.huss.mon1$"2019.04.", T.huss.mon1$"2019.05.", T.huss.mon1$"2019.06.", T.huss.mon1$"2019.07.", T.huss.mon1$"2019.08.", T.huss.mon1$"2019.09.", T.huss.mon1$"2019.10.", T.huss.mon1$"2019.11.", T.huss.mon1$"2019.12.")
stackedH_20 <- c(T.huss.mon1$"2020.01.", T.huss.mon1$"2020.02.", T.huss.mon1$"2020.03.", T.huss.mon1$"2020.04.", T.huss.mon1$"2020.05.", T.huss.mon1$"2020.06.", T.huss.mon1$"2020.07.", T.huss.mon1$"2020.08.", T.huss.mon1$"2020.09.", T.huss.mon1$"2020.10.", T.huss.mon1$"2020.11.", T.huss.mon1$"2020.12.")
#let's stack all the years atop of each other
stackedH_years <- c(stackedH_06, stackedH_07, stackedH_08, stackedH_09, stackedH_10, stackedH_11, stackedH_12, stackedH_13, stackedH_14, stackedH_15, stackedH_16, stackedH_17, stackedH_18, stackedH_19, stackedH_20)
stackedH16 <- c(T.huss.mon1$"2016.01.", T.huss.mon1$"2016.02.", T.huss.mon1$"2016.03.", T.huss.mon1$"2016.04.", T.huss.mon1$"2016.05.", T.huss.mon1$"2016.06.", T.huss.mon1$"2016.07.", T.huss.mon1$"2016.08.", T.huss.mon1$"2016.09.", T.huss.mon1$"2016.10.", T.huss.mon1$"2016.11.", T.huss.mon1$"2016.12.")
#let's stack all the years atop of each other
stackedH_years <- c(stackedH_06, stackedH_07, stackedH_08, stackedH_09, stackedH_10, stackedH_11, stackedH_12, stackedH_13, stackedH_14, stackedH_15, stackedH_16, stackedH_17, stackedH_18, stackedH_19, stackedH_20)
stackedH_16 <- c(T.huss.mon1$"2016.01.", T.huss.mon1$"2016.02.", T.huss.mon1$"2016.03.", T.huss.mon1$"2016.04.", T.huss.mon1$"2016.05.", T.huss.mon1$"2016.06.", T.huss.mon1$"2016.07.", T.huss.mon1$"2016.08.", T.huss.mon1$"2016.09.", T.huss.mon1$"2016.10.", T.huss.mon1$"2016.11.", T.huss.mon1$"2016.12.")
#let's stack all the years atop of each other
stackedH_years <- c(stackedH_06, stackedH_07, stackedH_08, stackedH_09, stackedH_10, stackedH_11, stackedH_12, stackedH_13, stackedH_14, stackedH_15, stackedH_16, stackedH_17, stackedH_18, stackedH_19, stackedH_20)
dengue_longformat$Humidity <- stackedH_years
#save the file in the repository
filePath = paste(dirname(getwd()), "Correlation_hypothesis", "den_hum_longformat.csv",sep = "/")
write.csv(dengue_longformat, filePath)
#load the needed dataframes
den_hum_longformat <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\den_hum_longformat.csv")
monsoon_longformat <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\monsoon_longformat.csv")
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue)
hist(den_hum_longformat$Humidity)
cor(den_hum_longformat$Dengue, den_hum_longformat$Humidity, use = "pairwise.complete.obs")
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue)
hist(den_hum_longformat$Humidity)
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue)
hist(den_hum_longformat$Humidity)
?hist
hist(den_hum_longformat$Dengue, xlab = "relative humidity")
hist(den_hum_longformat$Dengue, xlab = "Dengue cases per 100'000 people" )
hist(den_hum_longformat$Dengue,main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people" )
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people" )
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity" xlab = "relative humidity")
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people" )
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity")
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 20)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity")
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 50)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity")
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity")
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity", breaks = 50)
library(ggplot2)
# Set a random seed for reproducibility
set.seed(123)
# Generate example data for each distribution
# Normal distribution
data_normal <- rnorm(1000, mean = 10, sd = 2)
# Uniform distribution
data_uniform <- runif(1000, min = 5, max = 15)
# Exponential distribution
data_exponential <- rexp(1000, rate = 0.2)
# Skewed distribution (using a log-normal distribution)
data_skewed <- rlnorm(1000, meanlog = 2, sdlog = 0.5)
# Create a data frame to store the distributions and their labels
df <- data.frame(
Distribution = factor(rep(c("Normal", "Uniform", "Exponential", "Skewed"), each = 1000)),
Values = c(data_normal, data_uniform, data_exponential, data_skewed)
)
# Plot histograms for each distribution
ggplot(df, aes(x = Values, fill = Distribution)) +
geom_histogram(bins = 30, alpha = 0.6) +
labs(title = "Histograms of Different Distributions",
x = "Values",
y = "Frequency",
fill = "Distribution") +
theme_minimal()
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity", breaks = 50)
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity", breaks = 50)
# Set a random seed for reproducibility
set.seed(123)
# Generate example data for each distribution
# Normal distribution
data_normal <- rnorm(1000, mean = 10, sd = 2)
# Uniform distribution
data_uniform <- runif(1000, min = 5, max = 15)
# Exponential distribution
data_exponential <- rexp(1000, rate = 0.2)
# Skewed distribution (using a log-normal distribution)
data_skewed <- rlnorm(1000, meanlog = 2, sdlog = 0.5)
# Create a data frame to store the distributions and their labels
df <- data.frame(
Distribution = factor(rep(c("Normal", "Uniform", "Exponential", "Skewed"), each = 1000)),
Values = c(data_normal, data_uniform, data_exponential, data_skewed)
)
# Plot histograms for each distribution
ggplot(df, aes(x = Values, fill = Distribution)) +
geom_histogram(bins = 30, alpha = 0.6) +
labs(title = "Histograms of Different Distributions",
x = "Values",
y = "Frequency",
fill = "Distribution") +
theme_minimal()
cor(den_hum_longformat$Dengue, den_hum_longformat$Humidity, use = "pairwise.complete.obs")
den_hum_longformat <- na.omit(den_hum_longformat)
View(den_hum_longformat)
install.packages("stats")
library(stats)
# Annahme: Dein Dataframe heißt "mein_dataframe"
# Erstelle das Poisson-Modell:
linear_modell <- lm(Dengue ~ Humidity, data = den_hum_longformat)
# Gib eine Zusammenfassung des Modells aus:
summary(linear_modell)
install.packages("stats")
plot(den_hum_longformat$Humidity, den_hum_longformat$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000")
#summary of each variable and histogram
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity", breaks = 50)
#relationship of the two variables
plot(den_hum_longformat$Humidity, den_hum_longformat$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000")
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 1000)
#summary of each variable and histogram
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity", breaks = 50)
#relationship of the two variables
plot(den_hum_longformat$Humidity, den_hum_longformat$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000")
#remove the NA's
den_hum_longformat <- na.omit(den_hum_longformat)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(den_hum_longformat$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data <- den_hum_longformat[den_hum_longformat$Dengue <= quantile_95, ]
# Calculate the correlation between Humidity and the filtered Dengue cases
correlation <- cor(filtered_data$Humidity, filtered_data$Dengue)
# Print the correlation
print(correlation)
#remove the NA's
den_hum_longformat <- na.omit(den_hum_longformat)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_90 <- quantile(den_hum_longformat$Dengue, 0.90)
# Filter the data to keep only values within the 95% quantile range
filtered_data <- den_hum_longformat[den_hum_longformat$Dengue <= quantile_90, ]
# Calculate the correlation between Humidity and the filtered Dengue cases
correlation <- cor(filtered_data$Humidity, filtered_data$Dengue)
# Print the correlation
print(correlation)
# Calculate the correlation between Humidity and the filtered Dengue cases
correlation <- cor(filtered_data$Humidity, filtered_data$Dengue)
# Print the correlation
print(correlation)
#remove the NA's
den_hum_longformat <- na.omit(den_hum_longformat)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(den_hum_longformat$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data <- den_hum_longformat[den_hum_longformat$Dengue <= quantile_95, ]
# Calculate the correlation between Humidity and the filtered Dengue cases
correlation <- cor(filtered_data$Humidity, filtered_data$Dengue)
# Print the correlation
print(correlation)
# make a linear modell
linear_modell <- lm(Dengue ~ Humidity, data = filtered_data)
# Gib eine Zusammenfassung des Modells aus:
summary(linear_modell)
#summary of each variable and histogram
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity", breaks = 50)
#relationship of the two variables
plot(den_hum_longformat$Humidity, den_hum_longformat$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000",
main = "Scatterplot of both variables")
#remove the NA's
den_hum_longformat <- na.omit(den_hum_longformat)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(den_hum_longformat$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data <- den_hum_longformat[den_hum_longformat$Dengue <= quantile_95, ]
#new scatterplot to check if it looks better
plot(filtered_data$Humidity, filtered_data$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000",
main = "scatterplot within the 95% quantile")
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_99 <- quantile(den_hum_longformat$Dengue, 0.99)
# Filter the data to keep only values within the 95% quantile range
filtered_data <- den_hum_longformat[den_hum_longformat$Dengue <= quantile_99, ]
# Calculate the correlation between Humidity and the filtered Dengue cases
correlation <- cor(filtered_data$Humidity, filtered_data$Dengue)
# Print the correlation
print(correlation)
#remove the NA's
den_hum_longformat <- na.omit(den_hum_longformat)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(den_hum_longformat$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data <- den_hum_longformat[den_hum_longformat$Dengue <= quantile_95, ]
#new scatterplot to check if it looks better
plot(filtered_data$Humidity, filtered_data$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000",
main = "scatterplot within the 95% quantile")
# Calculate the correlation between Humidity and the filtered Dengue cases
correlation <- cor(filtered_data$Humidity, filtered_data$Dengue)
# Print the correlation
print(correlation)
# make a linear modell
linear_modell <- lm(Dengue ~ Humidity, data = filtered_data)
# Gib eine Zusammenfassung des Modells aus:
summary(linear_modell)
# make a linear modell
linear_modell <- lm(Dengue ~ Humidity, data = filtered_data)
# Gib eine Zusammenfassung des Modells aus:
summary(linear_modell)
library(ggplot2)
library(stats)
#load the needed dataframes
den_hum_longformat <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\den_hum_longformat.csv")
monsoon_longformat <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\monsoon_longformat.csv")
#summary of each variable and histogram
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity", breaks = 50)
#relationship of the two variables
plot(den_hum_longformat$Humidity, den_hum_longformat$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000",
main = "Scatterplot of both variables")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggplot2)
library(stats)
library(readxl)
#load the needed dataframes
den_hum_longformat <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\den_hum_longformat.csv")
monsoon_longformat <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\monsoon_longformat.csv")
popu_density_den_hum <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\stacked_dengue_population_density_humidity.csv")
#summary of each variable and histogram
summary(den_hum_longformat$Dengue)
summary(den_hum_longformat$Humidity)
hist(den_hum_longformat$Dengue, main = "Histogram of Dengue Cases", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity", xlab = "relative humidity", breaks = 50)
#relationship of the two variables
plot(den_hum_longformat$Humidity, den_hum_longformat$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000",
main = "Scatterplot of both variables")
#remove the NA's
den_hum_longformat <- na.omit(den_hum_longformat)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(den_hum_longformat$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data <- den_hum_longformat[den_hum_longformat$Dengue <= quantile_95, ]
#new scatterplot to check if it looks better
plot(filtered_data$Humidity, filtered_data$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000",
main = "scatterplot within the 95% quantile")
# Calculate the correlation between Humidity and the filtered Dengue cases
correlation <- cor(filtered_data$Humidity, filtered_data$Dengue)
# Print the correlation
print(correlation)
#we need the complete dataframe again, with the NA's otherwise calculating the lag is very difficult
den_hum_longformat1 <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\den_hum_longformat.csv")
#make a vector with 77 NA's
lag1 <- c(rep(NA, 77))
#get the dengue data from the longformat dataframe
dengue_lag1 <- den_hum_longformat1$Dengue
#add the NA's at the botoom of the dengue case Data in the longformat dataframe
dengue_lag1 <- c(dengue_lag1, lag1)
#remove the first 77 values from the vector
dengue_lag1 <- tail(dengue_lag1, -77)
#replace the dengue vector in the longformat dataframe with the lagged dengue data
den_hum_longformat1$Dengue <- dengue_lag1
#now we can do the same steps as with the non lagged correlation
#remove the NA's
den_hum_longformat1 <- na.omit(den_hum_longformat1)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(den_hum_longformat1$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data1 <- den_hum_longformat1[den_hum_longformat1$Dengue <= quantile_95, ]
# Calculate the correlation between Humidity and the filtered Dengue cases with a one month lag
correlation_lag1 <- cor(filtered_data1$Humidity, filtered_data1$Dengue)
correlation_lag1
# make another linear modell
linear_modell1 <- lm(Dengue ~ Humidity, data = filtered_data1)
# Summarize the modell
summary(linear_modell1)
#we need the complete dataframe again, with the NA's otherwise calculating the lag is very difficult
den_hum_longformat2 <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\den_hum_longformat.csv")
#make a vector with 77 NA's
lag2 <- c(rep(NA, 154))
#get the dengue data from the longformat dataframe
dengue_lag2 <- den_hum_longformat2$Dengue
#add the NA's at the bottom of the dengue case Data in the longformat dataframe
dengue_lag2 <- c(dengue_lag2, lag2)
#remove the first 154 values from the vector
dengue_lag2 <- tail(dengue_lag2, -154)
#replace the dengue vector in the longformat dataframe with the lagged dengue data
den_hum_longformat2$Dengue <- dengue_lag2
#now we can do the same steps as with the non lagged correlation
#remove the NA's
den_hum_longformat2 <- na.omit(den_hum_longformat2)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(den_hum_longformat2$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data2 <- den_hum_longformat2[den_hum_longformat2$Dengue <= quantile_95, ]
# Calculate the correlation between Humidity and the filtered Dengue cases with a one month lag
correlation_lag2 <- cor(filtered_data2$Humidity, filtered_data2$Dengue)
correlation_lag2
# make another linear modell
linear_modell2 <- lm(Dengue ~ Humidity, data = filtered_data2)
# Summarize the modell
summary(linear_modell2)
#we need the complete dataframe again, with the NA's otherwise calculating the lag is very difficult
den_hum_longformat3 <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\den_hum_longformat.csv")
#make a vector with 77 NA's
lag3 <- c(rep(NA, 231))
#get the dengue data from the longformat dataframe
dengue_lag3 <- den_hum_longformat3$Dengue
#add the NA's at the bottom of the dengue case Data in the longformat dataframe
dengue_lag3 <- c(dengue_lag3, lag3)
#remove the first 231 values from the vector
dengue_lag3 <- tail(dengue_lag3, -231)
#replace the dengue vector in the longformat dataframe with the lagged dengue data
den_hum_longformat3$Dengue <- dengue_lag3
#now we can do the same steps as with the non lagged correlation
#remove the NA's
den_hum_longformat3 <- na.omit(den_hum_longformat3)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(den_hum_longformat3$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data3 <- den_hum_longformat3[den_hum_longformat3$Dengue <= quantile_95, ]
# Calculate the correlation between Humidity and the filtered Dengue cases with a one month lag
correlation_lag3 <- cor(filtered_data3$Humidity, filtered_data3$Dengue)
correlation_lag3
# make another linear modell
linear_modell3 <- lm(Dengue ~ Humidity, data = filtered_data3)
# Summarize the modell
summary(linear_modell3)
#summary of each variable and histogram
summary(monsoon_longformat$Dengue)
summary(monsoon_longformat$Humidity)
hist(monsoon_longformat$Dengue, main = "Histogram of Dengue Cases in monsoon seasons", xlab = "Dengue cases per 100'000 people", breaks = 100)
hist(den_hum_longformat$Humidity, main ="Histogram of relative Humidity in monsoon seasons", xlab = "relative humidity", breaks = 50)
#mean of the respective seasons over all years of dengue and humidity
intermon <- subset(monsoon_longformat, monsoon_longformat$Season == "intermon")
mean_humidity_intermon <- mean(intermon$Humidity)
mean_dengue_intermon <- mean(intermon$Dengue, na.rm = TRUE)
premon <- subset(monsoon_longformat, monsoon_longformat$Season == "premon")
mean_humidity_premon <- mean(premon$Humidity)
mean_dengue_premon <- mean(premon$Dengue, na.rm = TRUE)
mon <- subset(monsoon_longformat, monsoon_longformat$Season == "mon")
mean_humidity_mon <- mean(mon$Humidity)
mean_dengue_mon <- mean(mon$Dengue, na.rm = TRUE)
postmon <- subset(monsoon_longformat, monsoon_longformat$Season == "postmon")
mean_humidity_postmon <- mean(postmon$Humidity)
mean_dengue_postmon <- mean(postmon$Dengue, na.rm = TRUE)
#humidity seasons means
mean_humidity_intermon
mean_humidity_premon
mean_humidity_mon
mean_humidity_postmon
#dengue seasons means
mean_dengue_intermon
mean_dengue_premon
mean_dengue_mon
mean_dengue_postmon
#relationship of the two variables
plot(monsoon_longformat$Humidity, monsoon_longformat$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000",
main = "Scatterplot of both variables")
#remove the NA's
monsoon_longformat <- na.omit(monsoon_longformat)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(monsoon_longformat$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data_mon <- monsoon_longformat[monsoon_longformat$Dengue <= quantile_95, ]
#new scatterplot to check if it looks better
plot(filtered_data_mon$Humidity, filtered_data_mon$Dengue,
pch=20,
xlab="relative Humidity",
ylab="Dengue cases per 100'000",
main = "Scatterplot within the 95% quantile")
# Calculate the correlation between Humidity and the filtered Dengue cases
correlation_mon <- cor(filtered_data_mon$Humidity, filtered_data_mon$Dengue)
# Print the correlation
print(correlation_mon)
# make a linear modell
linear_modell_mon <- lm(Dengue ~ Humidity, data = filtered_data_mon)
# Summarize the modell
summary(linear_modell_mon)
#we need the complete dataframe again, with the NA's otherwise calculating the lag is very difficult
monsoon_longformat1 <- read.csv("C:\\Users\\paula\\Documents\\Uni Heidelberg\\4. Semester\\Bioinformatik\\github\\topic04_team01\\Correlation_hypothesis\\monsoon_longformat.csv")
#make a vector with 77 NA's
lag1_mon <- c(rep(NA, 77))
#get the dengue data from the longformat dataframe
dengue_lag1_mon <- monsoon_longformat1$Dengue
#add the NA's at the bottom of the dengue case Data in monsoon seasons in the longformat dataframe
dengue_lag1_mon <- c(dengue_lag1_mon, lag1_mon)
#remove the first 77 values from the vector
dengue_lag1_mon <- tail(dengue_lag1_mon, -77)
#replace the dengue vector in the longformat dataframe with the lagged dengue data
monsoon_longformat1$Dengue <- dengue_lag1_mon
#now we can do the same steps as with the non lagged correlation
#remove the NA's
monsoon_longformat1 <- na.omit(monsoon_longformat1)
#only look at the 95% quantile range
## Calculate the 95th quantile of Dengue cases
quantile_95 <- quantile(monsoon_longformat1$Dengue, 0.95)
# Filter the data to keep only values within the 95% quantile range
filtered_data1_mon <- monsoon_longformat1[monsoon_longformat1$Dengue <= quantile_95, ]
# Calculate the correlation between Humidity and the filtered Dengue cases with a lag of one monsoon season
correlation_lag1_mon <- cor(filtered_data1_mon$Humidity, filtered_data1_mon$Dengue)
correlation_lag1_mon
# make another linear modell
linear_modell1_mon <- lm(Dengue ~ Humidity, data = filtered_data1_mon)
# summarize the modell
summary(linear_modell1_mon)
#remove the NA's
popu_density_den_hum <- na.omit(popu_density_den_hum)
#summary of each variable and histogram
summary(popu_density_den_hum$Dengue)
summary(popu_density_den_hum$Population_density)
hist(popu_density_den_hum$Dengue, main = "Histogram of Dengue Cases yearls", xlab = "Dengue cases per 100'000 people per year", breaks = 100)
hist(popu_density_den_hum$Population_density, main ="Histogram of population density", xlab = "population density", breaks = 50)
#relationship of the two variables
plot(popu_density_den_hum$Population_density, popu_density_den_hum$Dengue,
pch=20,
xlab="Population density",
ylab="Dengue cases per 100'000",
main = "Scatterplot of both variables")
#correlation between population density and dengeu cases
cor(popu_density_den_hum$Dengue,popu_density_den_hum$Population_density, )
# make another linear modell
linear_modell_popu <- lm(Dengue ~ Population_density, data = popu_density_den_hum)
# summarize the modell
summary(linear_modell_popu)
# Fit the multiple regression model
multiple_regression_model <- lm(Dengue ~ Humidity + Population_density, data = popu_density_den_hum)
# Get the summary of the model
summary(multiple_regression_model)
min(den_hum_longformat$Humidity)
mean(dengue_longformat$Humidity)
